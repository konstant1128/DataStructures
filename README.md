Сейчас код работает только с остатками, а не со строками, что делало его медленным
